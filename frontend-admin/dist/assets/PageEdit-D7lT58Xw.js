import{d as C,u as I,r as y,n as g,p as S,_ as E,F as M,c as z,b as a,w as s,e as l,N as F,a7 as c,f as R,a8 as V,g as q,h as n,i as d,l as b,C as N,z as k,P as A,a9 as D,a0 as L,k as _,B as P,o as O}from"./index-g5hkaJ8F.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"page-edit"},G={style:{color:"#999","font-size":"12px"}},H=C({__name:"PageEdit",setup(J){const w=S(),p=R(),u=I(),f=y(!1),m=y(!1),i=g(()=>w.params.id==="new"),x=g(()=>i.value?null:Number(w.params.id)),e=E({slug:"",title:"",subtitle:"",content:"",meta_description:"",status:"draft",sort_order:0}),v=g({get:()=>e.status==="published",set:o=>{e.status=o?"published":"draft"}}),U=async()=>{if(!i.value){f.value=!0;try{const o=await c.getDetail(x.value);if(o.code===200&&o.data){const t=o.data;e.slug=t.slug||"",e.title=t.title||"",e.subtitle=t.subtitle||"",e.content=t.content||"",e.meta_description=t.meta_description||"",e.status=t.status||"draft",e.sort_order=t.sort_order||0}else u.error(o.message||"åŠ è½½é¡µé¢å¤±è´¥"),p.push({name:"Pages"})}catch{u.error("åŠ è½½é¡µé¢å¤±è´¥"),p.push({name:"Pages"})}finally{f.value=!1}}},h=async()=>{if(!e.slug.trim()){u.warning("è¯·è¾“å…¥é¡µé¢æ ‡è¯†");return}if(!e.title.trim()){u.warning("è¯·è¾“å…¥é¡µé¢æ ‡é¢˜");return}m.value=!0;try{let o;i.value?o=await c.create({slug:e.slug,title:e.title,subtitle:e.subtitle,content:e.content,meta_description:e.meta_description,status:e.status,sort_order:e.sort_order}):o=await c.update(x.value,{title:e.title,subtitle:e.subtitle,content:e.content,meta_description:e.meta_description,status:e.status,sort_order:e.sort_order}),o.code===200?(u.success(i.value?"é¡µé¢åˆ›å»ºæˆåŠŸ":"é¡µé¢ä¿å­˜æˆåŠŸ"),p.push({name:"Pages"})):u.error(o.message||"ä¿å­˜å¤±è´¥")}catch{u.error("ä¿å­˜å¤±è´¥")}finally{m.value=!1}},B=()=>{p.push({name:"Pages"})};return M(()=>{U()}),(o,t)=>(O(),z("div",j,[a(l(F),{title:i.value?"æ–°å»ºé¡µé¢":"ç¼–è¾‘é¡µé¢"},{"header-extra":s(()=>[a(l(k),null,{default:s(()=>[a(l(P),{onClick:B},{default:s(()=>[...t[7]||(t[7]=[_("è¿”å›",-1)])]),_:1}),a(l(P),{type:"primary",loading:m.value,onClick:h},{default:s(()=>[...t[8]||(t[8]=[_(" ğŸ’¾ ä¿å­˜ ",-1)])]),_:1},8,["loading"])]),_:1})]),default:s(()=>[a(l(V),{show:f.value},{default:s(()=>[a(l(q),{"label-placement":"left","label-width":"100px",style:{"max-width":"900px"}},{default:s(()=>[a(l(n),{label:"é¡µé¢æ ‡è¯†",required:""},{feedback:s(()=>[b("span",G," è®¿é—®åœ°å€å°†æ˜¯ï¼š/"+N(e.slug||"xxx"),1)]),default:s(()=>[a(l(d),{value:e.slug,"onUpdate:value":t[0]||(t[0]=r=>e.slug=r),placeholder:"å¦‚ featuresã€pricingï¼ˆç”¨äº URLï¼‰",disabled:!i.value},null,8,["value","disabled"])]),_:1}),a(l(n),{label:"é¡µé¢æ ‡é¢˜",required:""},{default:s(()=>[a(l(d),{value:e.title,"onUpdate:value":t[1]||(t[1]=r=>e.title=r),placeholder:"é¡µé¢æ ‡é¢˜"},null,8,["value"])]),_:1}),a(l(n),{label:"é¡µé¢å‰¯æ ‡é¢˜"},{default:s(()=>[a(l(d),{value:e.subtitle,"onUpdate:value":t[2]||(t[2]=r=>e.subtitle=r),placeholder:"å¯é€‰çš„å‰¯æ ‡é¢˜"},null,8,["value"])]),_:1}),a(l(n),{label:"SEO æè¿°"},{default:s(()=>[a(l(d),{value:e.meta_description,"onUpdate:value":t[3]||(t[3]=r=>e.meta_description=r),type:"textarea",rows:2,placeholder:"ç”¨äºæœç´¢å¼•æ“çš„é¡µé¢æè¿°"},null,8,["value"])]),_:1}),a(l(n),{label:"å‘å¸ƒçŠ¶æ€"},{default:s(()=>[a(l(k),{align:"center"},{default:s(()=>[a(l(A),{value:v.value,"onUpdate:value":t[4]||(t[4]=r=>v.value=r)},null,8,["value"]),b("span",null,N(v.value?"å·²å‘å¸ƒ":"è‰ç¨¿"),1)]),_:1})]),_:1}),a(l(n),{label:"æ’åº"},{feedback:s(()=>[...t[9]||(t[9]=[b("span",{style:{color:"#999","font-size":"12px"}},"æ•°å­—è¶Šå°æ’åºè¶Šé å‰",-1)])]),default:s(()=>[a(l(D),{value:e.sort_order,"onUpdate:value":t[5]||(t[5]=r=>e.sort_order=r),min:0,max:999,style:{width:"150px"}},null,8,["value"])]),_:1}),a(l(n),{label:"é¡µé¢å†…å®¹"},{default:s(()=>[a(l(L),{type:"info",bordered:!1,style:{"margin-bottom":"12px",width:"100%"}},{default:s(()=>[...t[10]||(t[10]=[_(" æ”¯æŒ Markdown æ ¼å¼ï¼Œå¯ä½¿ç”¨æ ‡é¢˜ï¼ˆ##ï¼‰ã€åˆ—è¡¨ï¼ˆ-ï¼‰ã€åŠ ç²—ï¼ˆ**æ–‡å­—**ï¼‰ç­‰è¯­æ³• ",-1)])]),_:1}),a(l(d),{value:e.content,"onUpdate:value":t[6]||(t[6]=r=>e.content=r),type:"textarea",rows:20,placeholder:"é¡µé¢å†…å®¹ï¼ˆæ”¯æŒ Markdown æ ¼å¼ï¼‰",style:{"font-family":"monospace",width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["show"])]),_:1},8,["title"])]))}}),W=T(H,[["__scopeId","data-v-3f73e8da"]]);export{W as default};
